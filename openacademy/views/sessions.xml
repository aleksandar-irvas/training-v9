<?xml version="1.0" encoding="utf-8"?>
<openerp>
  <data>

    <record model="ir.ui.view" id="openacademy.session_view_list">
      <field name="name">openacademy session list</field>
      <field name="model">openacademy.session</field>
      <field name="arch" type="xml">
        <tree decoration-bf="(taken_seats &gt; 70)"
              colors="#0000ff:duration&lt;5;red:duration&gt;15"
              default_order="start_date">
          <field name="name"/>
          <field name="course_id" />
          <field name="instructor_id"   />
          <field name="start_date" />
          <field name="duration" />
          <field name="seats" />
          <field name="taken_seats" widget="progressbar"/>
        </tree>
      </field>
    </record>

    <record model="ir.ui.view" id="openacademy.session_view_form">
      <field name="name">openacademy session form</field>
      <field name="model">openacademy.session</field>
      <field name="arch" type="xml">
        <form>
          <sheet>
              <group>
                  <group>
                      <field name="name"/>
                      <field name="course_id" />
                      <field name="responsible_id" />
                      <field name="level" />
                      <field name="instructor_id" domain="['&amp;', ('instructor', '=', True), ('level', '&gt;=', level)]" />
                      <field name="active" />
                  </group>
                  <group>
                      <field name="start_date" />
                      <field name="end_date" />
                      <field name="duration" />
                      <label for="percentage_per_day" string="Percentage per day" />
                      <field name="percentage_per_day" nolabel="1"/>
                      <field name="seats" />
                      <field name="taken_seats" widget="progressbar"/>
                  </group>
              </group>
              <label for="attendee_ids"/>
              <field name="attendee_ids"/>
          </sheet>
         </form>
      </field>
    </record>

    <record model="ir.ui.view" id="session_calendar_view">
        <field name="name">session.calendar</field>
        <field name="model">openacademy.session</field>
        <field name="arch" type="xml">
            <calendar string="Session Calendar"
                      date_start="start_date"
                      date_stop="end_date"
                      color="instructor_id">
                <field name="name"/>
                <field name="taken_seats" />
            </calendar>
        </field>
    </record>

    <record model="ir.ui.view" id="openacademy.session_view_search">
      <field name="name">openacademy session search</field>
      <field name="model">openacademy.session</field>
      <field name="arch" type="xml">
        <search>
            <field name="name"/>
            <field name="course_id" />
            <field name="instructor_id" />
            <filter name="by_instructor" string="Instructor"
                        context="{'group_by': 'instructor_id'}"/>
         </search>
      </field>
    </record>

    <record id="session_view_gantt" model="ir.ui.view">
        <field name="name">openacademy.session.gantt</field>
        <field name="model">openacademy.session</field>
        <field name="arch" type="xml">
          <gantt type="consolidate"
                 date_start="start_date"
                 date_stop="end_date"
                 fold_last_level="true"
                 round_dnd_dates="true"
                 consolidation="percentage_per_day"
                 consolidation_max = '{"instructor_id": 100, "responsible_id" : 200}'
                 consolidation_exclude = "exclude"
                 >
          </gantt>
        </field>
    </record>


    <record model="ir.actions.act_window" id="openacademy.action_session">
      <field name="name">openacademy session</field>
      <field name="res_model">openacademy.session</field>
      <field name="view_mode">tree,form,calendar</field>
      <field name="help" type="html">
          <p class="oe_view_nocontent_create">Create your first session</p>
      </field>
    </record>

    <!-- actions -->
    <menuitem name="Sessions" id="openacademy.menu_session" parent="openacademy.menu_course_top"
              action="openacademy.action_session"/>

    <record model="ir.actions.act_window" id="openacademy.action_session_schedule">
      <field name="name">openacademy session schedule</field>
      <field name="res_model">openacademy.session</field>
      <field name="view_mode">gantt</field>
      <field name="context">{'search_default_by_instructor' : 1 }</field>
    </record>

    <menuitem name="Scheduling" id="openacademy.menu_scheduling"
              parent="openacademy.menu_root" />
    <menuitem name="Sessions" id="openacademy.menu_session_scheduling"
              parent="openacademy.menu_scheduling"
              action="openacademy.action_session_schedule"/>
  </data>
</openerp>